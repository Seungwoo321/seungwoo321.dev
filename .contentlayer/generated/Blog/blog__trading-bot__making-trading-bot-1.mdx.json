{
  "title": "Amazon Athena SQL로 캔들 데이터 생성 하기",
  "date": "2021-04-25T00:00:00.000Z",
  "tags": [
    "Athena",
    "SQL",
    "Trading Bot"
  ],
  "draft": true,
  "summary": "처음 계획은 노드(node.js)로 코빗 거래소의 ticker API를 정기적으로 호출해서 받은 시장 데이터 중 종목, 가격, 시간 데이터만 키네시스(Kinesis) 서비스로 전송하고 그다음 글루(Glue) 서비스로 ETL 작업을 수행해서 데이터를 가공해 아테나(Athena)에 최종 캔들 테이블을 생성하는 것이었다.",
  "body": {
    "raw": "\n> 이 글은 2018년 4월경 테스트를 진행하면서 Evernote에 기록한 내용을 바탕으로 작성했습니다.\n\n암호화폐 시장을 경험하면서 차트 분석을 접하고 알고리즘 매매에 흥미를 갖게 되었습니다. 차트 기반으로 동작하는 알고리즘을 만들기 위해서는 차트 분석에 사용될 보조지표가 필요할 것이고 이 지표를 계산하기 위해서는 우선 가장 기본이 되는 캔들이 필요합니다.\n\n모든 거래소가 원하는 시간 프레임의 캔들 데이터를 실시간으로 제공하지는 않습니다. 하지만 언제 얼마에 얼마큼 거래가 이루어졌는지에 대한 정보만 있으면 이 데이터를 사용해서 모아서 실시간 캔들 데이터를 만들 수 있을 것입니다. 실제로 어떻게 구현할지 고민하다가 이 기회에 AWS의 데이터 분석 서비스인 Glue와 Athena를 사용해 보기로 했습니다.\n\n## 수집 및 데이터 가공\n\n캔들은 **종가(close)**, **고가(high)**, **저가(low)**, **시가(open)**로 구성되어 있습니다.\n\n### 가공 프로세스\n\n계획은 노드(node.js)로 코빗 거래소의 ticker API를 정기적으로 호출해서 받은 시장 데이터 중 종목, 가격, 시간 데이터만 키네시스(Kinesis) 서비스로 전송하고 그다음 글루(Glue) 서비스로 ETL을 수행해서 아테나(Athena)에 최종 캔들 테이블을 생성하는 것이었습니다. 그런데 ETL에 대한 이해도가 부족하다 보니 글루 서비스로 캔들 데이터를 생성하는 데서 막혔습니다. 당장 실행이라도 해볼 수 있는 방법을 고민하다가 아테나에 테이블을 만든 다음 실시간으로 받은 종목, 가격, 시간 데이터를 가공하지 않은 채로 저장하고 SQL을 사용해서 캔들 데이터를 만들기로 했습니다.\n\n## Athena SQL을 사용해 시장 데이터를 캔들 데이터로 가공하기\n\n구글링을 통해 알게 된 여러 가지 함수와 수 년 만에 SQL 지식을 되뇌면서 열심히 작성한 결과 지정한 시간 프레임 별로 그룹화를 해서 그룹화된 시간의 최소 가격과 최대 가격과 지정한 시간 프레임별로 시작 순간과 끝 순간의 가격을 모두 구하는 쿼리문을 작성할 수 있었습니다.\n\n```sql:5분 캔들 데이터\n\nselect\n    a1.timestamp\n    , a1.open_timestamp\n    , b1.col1 as open\n    , a1.close_timestamp\n    , c1.col1 as close\n    , a1.high\n    , a1.low\nfrom (\n    select\n        case floor(minute(from_iso8601_timestamp(col0)) / 5)\n            when 0 then date_format(date_trunc('second', from_iso8601_timestamp(col0)) + interval '9' hour, '%Y-%m-%d %H:00')\n            when 1 then date_format(date_trunc('second', from_iso8601_timestamp(col0)) + interval '9' hour, '%Y-%m-%d %H:05')\n            when 2 then date_format(date_trunc('second', from_iso8601_timestamp(col0)) + interval '9' hour, '%Y-%m-%d %H:10')\n            when 3 then date_format(date_trunc('second', from_iso8601_timestamp(col0)) + interval '9' hour, '%Y-%m-%d %H:15')\n            when 4 then date_format(date_trunc('second', from_iso8601_timestamp(col0)) + interval '9' hour, '%Y-%m-%d %H:20')\n            when 5 then date_format(date_trunc('second', from_iso8601_timestamp(col0)) + interval '9' hour, '%Y-%m-%d %H:25')\n            when 6 then date_format(date_trunc('second', from_iso8601_timestamp(col0)) + interval '9' hour, '%Y-%m-%d %H:30')\n            when 7 then date_format(date_trunc('second', from_iso8601_timestamp(col0)) + interval '9' hour, '%Y-%m-%d %H:35')\n            when 8 then date_format(date_trunc('second', from_iso8601_timestamp(col0)) + interval '9' hour, '%Y-%m-%d %H:40')\n            when 9 then date_format(date_trunc('second', from_iso8601_timestamp(col0)) + interval '9' hour, '%Y-%m-%d %H:45')\n            when 10 then date_format(date_trunc('second', from_iso8601_timestamp(col0)) + interval '9' hour, '%Y-%m-%d %H:50')\n            when 11 then date_format(date_trunc('second', from_iso8601_timestamp(col0)) + interval '9' hour, '%Y-%m-%d %H:55')\n        end as timestamp\n        , min(from_iso8601_timestamp(col0)) as open_timestamp\n        , max(from_iso8601_timestamp(col0)) as close_timestamp\n        , max(col1) as high\n        , min(col1) as low\n    from trading.swlee_ticker\n    where col2 = 'eth_krw'\n    group by 1\n    order by 1\n) a1\nleft join (\n    select distinct\n        from_iso8601_timestamp(col0) as original_timestamp\n        , col1\n    from trading.swlee_ticker\n    where col2 = 'eth_krw'\n    order by 1\n) b1\non a1.open_timestamp = b1.original_timestamp\nleft join (\n    select distinct\n        from_iso8601_timestamp(col0) as original_timestamp\n        , col1\n    from trading.swlee_ticker\n    where col2 = 'eth_krw'\n    order by 1\n) c1\non a1.close_timestamp = c1.original_timestamp\nwhere a1.timestamp is not null\norder by 1\n```\n\n```sql:30분 캔들 데이터\nselect\n    a1.timestamp\n    , a1.open_timestamp\n    , b1.col1 as open\n    , a1.close_timestamp\n    , c1.col1 as close\n    , a1.high\n    , a1.low\nfrom (\n    select\n        case floor(minute(from_iso8601_timestamp(col0)) / 30)\n        when 0 then date_format(date_trunc('second', from_iso8601_timestamp(col0)) + interval '9' hour, '%Y-%m-%d %H:00')\n        when 1 then date_format(date_trunc('second', from_iso8601_timestamp(col0)) + interval '9' hour, '%Y-%m-%d %H:30')\n        end as timestamp\n        , min(from_iso8601_timestamp(col0)) as open_timestamp\n        , max(from_iso8601_timestamp(col0)) as close_timestamp\n        , max(col1) as high\n        , min(col1) as low\n    from trading.swlee_ticker\n    where col2 = 'eth_krw'\n    group by 1\n    order by 1\n) a1\nleft join (\n    select distinct\n        from_iso8601_timestamp(col0) as original_timestamp\n        , col1\n    from trading.swlee_ticker\n    where col2 = 'eth_krw'\n    order by 1\n) b1\non a1.open_timestamp = b1.original_timestamp\nleft join (\n    select distinct\n        from_iso8601_timestamp(col0) as original_timestamp\n        , col1\n    from trading.swlee_ticker\n    where col2 = 'eth_krw'\n    order by 1\n) c1\non a1.close_timestamp = c1.original_timestamp\nwhere a1.timestamp is not null\norder by 1\n```\n\n```sql:1시간 캔들 데이터\nselect\n    a1.timestamp\n    , a1.open_timestamp\n    , b1.col1 as open\n    , a1.close_timestamp\n    , c1.col1 as close\n    , a1.high\n    , a1.low\nfrom (\n    select\n        case floor(minute(from_iso8601_timestamp(col0)))\n        when 0 then date_format(date_trunc('hour', from_iso8601_timestamp(col0)) + interval '9' hour, '%Y-%m-%d %H:00')\n        end as timestamp\n        , min(from_iso8601_timestamp(col0)) as open_timestamp\n        , max(from_iso8601_timestamp(col0)) as close_timestamp\n        , max(col1) as high\n        , min(col1) as low\n    from trading.swlee_ticker\n    where col2 = 'eth_krw'\n    group by 1\n    order by 1\n) a1 left join (\n    select distinct\n        from_iso8601_timestamp(col0) as original_timestamp\n        , col1\n    from trading.swlee_ticker\n    where col2 = 'eth_krw'\n    order by 1\n) b1\non a1.open_timestamp = b1.original_timestamp\nleft join (\n    select distinct\n        from_iso8601_timestamp(col0) as original_timestamp\n        , col1\n    from trading.swlee_ticker\n    where col2 = 'eth_krw'\n    order by 1\n) c1\non a1.close_timestamp = c1.original_timestamp\nwhere a1.timestamp is not null\norder by 1\n```\n\n```sql:4시간 캔들 데이터\nselect\n    a1.timestamp\n    , a1.open_timestamp\n    , b1.col1 as open\n    , a1.close_timestamp\n    , c1.col1 as close\n    , a1.high\n    , a1.low\nfrom (\n    select\n        case floor(hour(from_iso8601_timestamp(col0)) / 4)\n        when 0 then date_format(date_trunc('hour', from_iso8601_timestamp(col0)) + interval '9' hour, '%Y-%m-%d 00:00')\n        when 1 then date_format(date_trunc('hour', from_iso8601_timestamp(col0)) + interval '9' hour, '%Y-%m-%d 04:00')\n        when 2 then date_format(date_trunc('hour', from_iso8601_timestamp(col0)) + interval '9' hour, '%Y-%m-%d 08:00')\n        when 3 then date_format(date_trunc('hour', from_iso8601_timestamp(col0)) + interval '9' hour, '%Y-%m-%d 12:00')\n        when 4 then date_format(date_trunc('hour', from_iso8601_timestamp(col0)) + interval '9' hour, '%Y-%m-%d 16:00')\n        when 5 then date_format(date_trunc('hour', from_iso8601_timestamp(col0)) + interval '9' hour, '%Y-%m-%d 18:00')\n        end as timestamp\n        , min(from_iso8601_timestamp(col0)) as open_timestamp\n        , max(from_iso8601_timestamp(col0)) as close_timestamp\n        , max(col1) as high\n        , min(col1) as low\n    from trading.swlee_ticker\n    where col2 = 'eth_krw'\n    group by 1\n    order by 1\n) a1 left join (\n        select distinct\n        from_iso8601_timestamp(col0) as original_timestamp\n        , col1\n        from trading.swlee_ticker\n    where col2 = 'eth_krw'\n    order by 1\n) b1\non a1.open_timestamp = b1.original_timestamp\nleft join (\n    select distinct\n        from_iso8601_timestamp(col0) as original_timestamp\n        , col1\n    from trading.swlee_ticker\n    where col2 = 'eth_krw'\n    order by 1\n) c1\non a1.close_timestamp = c1.original_timestamp\nwhere a1.timestamp is not null\norder by 1\n\n```\n\n## 실행 결과\n\n![Write SQL](/static/images/posts/2021/04/25/01_sql.png)\n\n![Run SQL](/static/images/posts/2021/04/25/02_result.png)\n\n## 정리\n\n* 가장 기본이 되는 캔들 생성만으로 복잡하고 비용이 많이 든다.\n* 글루 서비스에서 생성하는 ticker 테이블이 배치성이라서 실시간 캔들 조회가 어렵다.\n\n원하는 시간 프레임별로 캔들 데이터를 생성하는 SQL 문을 작성하는 것은 성공했지만, 위와 같은 이유들로 비효율적이라고 판단해 작업에 사용된 모든 AWS 리소스(resource)를 삭제하고 다른 방법을 시도하게 되었다.\n",
    "code": "var Component=(()=>{var p=Object.create;var l=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var k=Object.getPrototypeOf,N=Object.prototype.hasOwnProperty;var u=(a,n)=>()=>(n||a((n={exports:{}}).exports,n),n.exports),w=(a,n)=>{for(var s in n)l(a,s,{get:n[s],enumerable:!0})},o=(a,n,s,t)=>{if(n&&typeof n==\"object\"||typeof n==\"function\")for(let c of h(n))!N.call(a,c)&&c!==s&&l(a,c,{get:()=>n[c],enumerable:!(t=m(n,c))||t.enumerable});return a};var y=(a,n,s)=>(s=a!=null?p(k(a)):{},o(n||!a||!a.__esModule?l(s,\"default\",{value:a,enumerable:!0}):s,a)),_=a=>o(l({},\"__esModule\",{value:!0}),a);var r=u((j,i)=>{i.exports=_jsx_runtime});var x={};w(x,{default:()=>b,frontmatter:()=>g});var e=y(r()),g={title:\"Amazon Athena SQL\\uB85C \\uCE94\\uB4E4 \\uB370\\uC774\\uD130 \\uC0DD\\uC131 \\uD558\\uAE30\",date:\"2021-04-25\",tags:[\"Athena\",\"SQL\",\"Trading Bot\"],draft:!0,summary:\"\\uCC98\\uC74C \\uACC4\\uD68D\\uC740 \\uB178\\uB4DC(node.js)\\uB85C \\uCF54\\uBE57 \\uAC70\\uB798\\uC18C\\uC758 ticker API\\uB97C \\uC815\\uAE30\\uC801\\uC73C\\uB85C \\uD638\\uCD9C\\uD574\\uC11C \\uBC1B\\uC740 \\uC2DC\\uC7A5 \\uB370\\uC774\\uD130 \\uC911 \\uC885\\uBAA9, \\uAC00\\uACA9, \\uC2DC\\uAC04 \\uB370\\uC774\\uD130\\uB9CC \\uD0A4\\uB124\\uC2DC\\uC2A4(Kinesis) \\uC11C\\uBE44\\uC2A4\\uB85C \\uC804\\uC1A1\\uD558\\uACE0 \\uADF8\\uB2E4\\uC74C \\uAE00\\uB8E8(Glue) \\uC11C\\uBE44\\uC2A4\\uB85C ETL \\uC791\\uC5C5\\uC744 \\uC218\\uD589\\uD574\\uC11C \\uB370\\uC774\\uD130\\uB97C \\uAC00\\uACF5\\uD574 \\uC544\\uD14C\\uB098(Athena)\\uC5D0 \\uCD5C\\uC885 \\uCE94\\uB4E4 \\uD14C\\uC774\\uBE14\\uC744 \\uC0DD\\uC131\\uD558\\uB294 \\uAC83\\uC774\\uC5C8\\uB2E4.\"};function d(a){let n=Object.assign({blockquote:\"blockquote\",p:\"p\",h2:\"h2\",a:\"a\",span:\"span\",strong:\"strong\",h3:\"h3\",div:\"div\",pre:\"pre\",code:\"code\",ul:\"ul\",li:\"li\"},a.components),{Image:s}=n;return s||v(\"Image\",!0,\"226:1-226:57\"),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(n.blockquote,{children:(0,e.jsx)(n.p,{children:\"\\uC774 \\uAE00\\uC740 2018\\uB144 4\\uC6D4\\uACBD \\uD14C\\uC2A4\\uD2B8\\uB97C \\uC9C4\\uD589\\uD558\\uBA74\\uC11C Evernote\\uC5D0 \\uAE30\\uB85D\\uD55C \\uB0B4\\uC6A9\\uC744 \\uBC14\\uD0D5\\uC73C\\uB85C \\uC791\\uC131\\uD588\\uC2B5\\uB2C8\\uB2E4.\"})}),(0,e.jsx)(n.p,{children:\"\\uC554\\uD638\\uD654\\uD3D0 \\uC2DC\\uC7A5\\uC744 \\uACBD\\uD5D8\\uD558\\uBA74\\uC11C \\uCC28\\uD2B8 \\uBD84\\uC11D\\uC744 \\uC811\\uD558\\uACE0 \\uC54C\\uACE0\\uB9AC\\uC998 \\uB9E4\\uB9E4\\uC5D0 \\uD765\\uBBF8\\uB97C \\uAC16\\uAC8C \\uB418\\uC5C8\\uC2B5\\uB2C8\\uB2E4. \\uCC28\\uD2B8 \\uAE30\\uBC18\\uC73C\\uB85C \\uB3D9\\uC791\\uD558\\uB294 \\uC54C\\uACE0\\uB9AC\\uC998\\uC744 \\uB9CC\\uB4E4\\uAE30 \\uC704\\uD574\\uC11C\\uB294 \\uCC28\\uD2B8 \\uBD84\\uC11D\\uC5D0 \\uC0AC\\uC6A9\\uB420 \\uBCF4\\uC870\\uC9C0\\uD45C\\uAC00 \\uD544\\uC694\\uD560 \\uAC83\\uC774\\uACE0 \\uC774 \\uC9C0\\uD45C\\uB97C \\uACC4\\uC0B0\\uD558\\uAE30 \\uC704\\uD574\\uC11C\\uB294 \\uC6B0\\uC120 \\uAC00\\uC7A5 \\uAE30\\uBCF8\\uC774 \\uB418\\uB294 \\uCE94\\uB4E4\\uC774 \\uD544\\uC694\\uD569\\uB2C8\\uB2E4.\"}),(0,e.jsx)(n.p,{children:\"\\uBAA8\\uB4E0 \\uAC70\\uB798\\uC18C\\uAC00 \\uC6D0\\uD558\\uB294 \\uC2DC\\uAC04 \\uD504\\uB808\\uC784\\uC758 \\uCE94\\uB4E4 \\uB370\\uC774\\uD130\\uB97C \\uC2E4\\uC2DC\\uAC04\\uC73C\\uB85C \\uC81C\\uACF5\\uD558\\uC9C0\\uB294 \\uC54A\\uC2B5\\uB2C8\\uB2E4. \\uD558\\uC9C0\\uB9CC \\uC5B8\\uC81C \\uC5BC\\uB9C8\\uC5D0 \\uC5BC\\uB9C8\\uD07C \\uAC70\\uB798\\uAC00 \\uC774\\uB8E8\\uC5B4\\uC84C\\uB294\\uC9C0\\uC5D0 \\uB300\\uD55C \\uC815\\uBCF4\\uB9CC \\uC788\\uC73C\\uBA74 \\uC774 \\uB370\\uC774\\uD130\\uB97C \\uC0AC\\uC6A9\\uD574\\uC11C \\uBAA8\\uC544\\uC11C \\uC2E4\\uC2DC\\uAC04 \\uCE94\\uB4E4 \\uB370\\uC774\\uD130\\uB97C \\uB9CC\\uB4E4 \\uC218 \\uC788\\uC744 \\uAC83\\uC785\\uB2C8\\uB2E4. \\uC2E4\\uC81C\\uB85C \\uC5B4\\uB5BB\\uAC8C \\uAD6C\\uD604\\uD560\\uC9C0 \\uACE0\\uBBFC\\uD558\\uB2E4\\uAC00 \\uC774 \\uAE30\\uD68C\\uC5D0 AWS\\uC758 \\uB370\\uC774\\uD130 \\uBD84\\uC11D \\uC11C\\uBE44\\uC2A4\\uC778 Glue\\uC640 Athena\\uB97C \\uC0AC\\uC6A9\\uD574 \\uBCF4\\uAE30\\uB85C \\uD588\\uC2B5\\uB2C8\\uB2E4.\"}),(0,e.jsxs)(n.h2,{id:\"\\uC218\\uC9D1-\\uBC0F-\\uB370\\uC774\\uD130-\\uAC00\\uACF5\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#\\uC218\\uC9D1-\\uBC0F-\\uB370\\uC774\\uD130-\\uAC00\\uACF5\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uC218\\uC9D1 \\uBC0F \\uB370\\uC774\\uD130 \\uAC00\\uACF5\"]}),(0,e.jsxs)(n.p,{children:[\"\\uCE94\\uB4E4\\uC740 \",(0,e.jsx)(n.strong,{children:\"\\uC885\\uAC00(close)\"}),\", \",(0,e.jsx)(n.strong,{children:\"\\uACE0\\uAC00(high)\"}),\", \",(0,e.jsx)(n.strong,{children:\"\\uC800\\uAC00(low)\"}),\", **\\uC2DC\\uAC00(open)**\\uB85C \\uAD6C\\uC131\\uB418\\uC5B4 \\uC788\\uC2B5\\uB2C8\\uB2E4.\"]}),(0,e.jsxs)(n.h3,{id:\"\\uAC00\\uACF5-\\uD504\\uB85C\\uC138\\uC2A4\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#\\uAC00\\uACF5-\\uD504\\uB85C\\uC138\\uC2A4\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uAC00\\uACF5 \\uD504\\uB85C\\uC138\\uC2A4\"]}),(0,e.jsx)(n.p,{children:\"\\uACC4\\uD68D\\uC740 \\uB178\\uB4DC(node.js)\\uB85C \\uCF54\\uBE57 \\uAC70\\uB798\\uC18C\\uC758 ticker API\\uB97C \\uC815\\uAE30\\uC801\\uC73C\\uB85C \\uD638\\uCD9C\\uD574\\uC11C \\uBC1B\\uC740 \\uC2DC\\uC7A5 \\uB370\\uC774\\uD130 \\uC911 \\uC885\\uBAA9, \\uAC00\\uACA9, \\uC2DC\\uAC04 \\uB370\\uC774\\uD130\\uB9CC \\uD0A4\\uB124\\uC2DC\\uC2A4(Kinesis) \\uC11C\\uBE44\\uC2A4\\uB85C \\uC804\\uC1A1\\uD558\\uACE0 \\uADF8\\uB2E4\\uC74C \\uAE00\\uB8E8(Glue) \\uC11C\\uBE44\\uC2A4\\uB85C ETL\\uC744 \\uC218\\uD589\\uD574\\uC11C \\uC544\\uD14C\\uB098(Athena)\\uC5D0 \\uCD5C\\uC885 \\uCE94\\uB4E4 \\uD14C\\uC774\\uBE14\\uC744 \\uC0DD\\uC131\\uD558\\uB294 \\uAC83\\uC774\\uC5C8\\uC2B5\\uB2C8\\uB2E4. \\uADF8\\uB7F0\\uB370 ETL\\uC5D0 \\uB300\\uD55C \\uC774\\uD574\\uB3C4\\uAC00 \\uBD80\\uC871\\uD558\\uB2E4 \\uBCF4\\uB2C8 \\uAE00\\uB8E8 \\uC11C\\uBE44\\uC2A4\\uB85C \\uCE94\\uB4E4 \\uB370\\uC774\\uD130\\uB97C \\uC0DD\\uC131\\uD558\\uB294 \\uB370\\uC11C \\uB9C9\\uD614\\uC2B5\\uB2C8\\uB2E4. \\uB2F9\\uC7A5 \\uC2E4\\uD589\\uC774\\uB77C\\uB3C4 \\uD574\\uBCFC \\uC218 \\uC788\\uB294 \\uBC29\\uBC95\\uC744 \\uACE0\\uBBFC\\uD558\\uB2E4\\uAC00 \\uC544\\uD14C\\uB098\\uC5D0 \\uD14C\\uC774\\uBE14\\uC744 \\uB9CC\\uB4E0 \\uB2E4\\uC74C \\uC2E4\\uC2DC\\uAC04\\uC73C\\uB85C \\uBC1B\\uC740 \\uC885\\uBAA9, \\uAC00\\uACA9, \\uC2DC\\uAC04 \\uB370\\uC774\\uD130\\uB97C \\uAC00\\uACF5\\uD558\\uC9C0 \\uC54A\\uC740 \\uCC44\\uB85C \\uC800\\uC7A5\\uD558\\uACE0 SQL\\uC744 \\uC0AC\\uC6A9\\uD574\\uC11C \\uCE94\\uB4E4 \\uB370\\uC774\\uD130\\uB97C \\uB9CC\\uB4E4\\uAE30\\uB85C \\uD588\\uC2B5\\uB2C8\\uB2E4.\"}),(0,e.jsxs)(n.h2,{id:\"athena-sql\\uC744-\\uC0AC\\uC6A9\\uD574-\\uC2DC\\uC7A5-\\uB370\\uC774\\uD130\\uB97C-\\uCE94\\uB4E4-\\uB370\\uC774\\uD130\\uB85C-\\uAC00\\uACF5\\uD558\\uAE30\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#athena-sql\\uC744-\\uC0AC\\uC6A9\\uD574-\\uC2DC\\uC7A5-\\uB370\\uC774\\uD130\\uB97C-\\uCE94\\uB4E4-\\uB370\\uC774\\uD130\\uB85C-\\uAC00\\uACF5\\uD558\\uAE30\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Athena SQL\\uC744 \\uC0AC\\uC6A9\\uD574 \\uC2DC\\uC7A5 \\uB370\\uC774\\uD130\\uB97C \\uCE94\\uB4E4 \\uB370\\uC774\\uD130\\uB85C \\uAC00\\uACF5\\uD558\\uAE30\"]}),(0,e.jsx)(n.p,{children:\"\\uAD6C\\uAE00\\uB9C1\\uC744 \\uD1B5\\uD574 \\uC54C\\uAC8C \\uB41C \\uC5EC\\uB7EC \\uAC00\\uC9C0 \\uD568\\uC218\\uC640 \\uC218 \\uB144 \\uB9CC\\uC5D0 SQL \\uC9C0\\uC2DD\\uC744 \\uB418\\uB1CC\\uBA74\\uC11C \\uC5F4\\uC2EC\\uD788 \\uC791\\uC131\\uD55C \\uACB0\\uACFC \\uC9C0\\uC815\\uD55C \\uC2DC\\uAC04 \\uD504\\uB808\\uC784 \\uBCC4\\uB85C \\uADF8\\uB8F9\\uD654\\uB97C \\uD574\\uC11C \\uADF8\\uB8F9\\uD654\\uB41C \\uC2DC\\uAC04\\uC758 \\uCD5C\\uC18C \\uAC00\\uACA9\\uACFC \\uCD5C\\uB300 \\uAC00\\uACA9\\uACFC \\uC9C0\\uC815\\uD55C \\uC2DC\\uAC04 \\uD504\\uB808\\uC784\\uBCC4\\uB85C \\uC2DC\\uC791 \\uC21C\\uAC04\\uACFC \\uB05D \\uC21C\\uAC04\\uC758 \\uAC00\\uACA9\\uC744 \\uBAA8\\uB450 \\uAD6C\\uD558\\uB294 \\uCFFC\\uB9AC\\uBB38\\uC744 \\uC791\\uC131\\uD560 \\uC218 \\uC788\\uC5C8\\uC2B5\\uB2C8\\uB2E4.\"}),(0,e.jsx)(n.div,{className:\"remark-code-title\",children:\"5\\uBD84\"}),(0,e.jsx)(n.pre,{className:\"language-sql\",children:(0,e.jsxs)(n.code,{className:\"language-sql code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"select\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    a1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"timestamp\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" a1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`open_timestamp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" b1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"col1 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"open\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" a1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`close_timestamp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" c1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"col1 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"close\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" a1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`high\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" a1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`low\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"select\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"case\"}),\" floor\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"minute\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"/\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"5\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"when\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"then\"}),\" date_format\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"date_trunc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'second'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"interval\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'9'\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"hour\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'%Y-%m-%d %H:00'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"when\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"then\"}),\" date_format\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"date_trunc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'second'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"interval\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'9'\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"hour\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'%Y-%m-%d %H:05'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"when\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"then\"}),\" date_format\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"date_trunc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'second'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"interval\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'9'\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"hour\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'%Y-%m-%d %H:10'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"when\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"3\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"then\"}),\" date_format\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"date_trunc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'second'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"interval\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'9'\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"hour\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'%Y-%m-%d %H:15'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"when\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"4\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"then\"}),\" date_format\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"date_trunc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'second'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"interval\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'9'\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"hour\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'%Y-%m-%d %H:20'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"when\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"5\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"then\"}),\" date_format\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"date_trunc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'second'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"interval\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'9'\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"hour\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'%Y-%m-%d %H:25'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"when\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"6\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"then\"}),\" date_format\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"date_trunc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'second'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"interval\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'9'\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"hour\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'%Y-%m-%d %H:30'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"when\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"7\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"then\"}),\" date_format\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"date_trunc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'second'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"interval\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'9'\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"hour\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'%Y-%m-%d %H:35'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"when\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"8\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"then\"}),\" date_format\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"date_trunc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'second'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"interval\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'9'\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"hour\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'%Y-%m-%d %H:40'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"when\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"9\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"then\"}),\" date_format\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"date_trunc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'second'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"interval\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'9'\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"hour\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'%Y-%m-%d %H:45'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"when\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"10\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"then\"}),\" date_format\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"date_trunc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'second'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"interval\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'9'\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"hour\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'%Y-%m-%d %H:50'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"when\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"11\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"then\"}),\" date_format\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"date_trunc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'second'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"interval\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'9'\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"hour\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'%Y-%m-%d %H:55'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"end\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"timestamp\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"min\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),` open_timestamp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"max\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),` close_timestamp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"max\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),` high\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"min\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),` low\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" trading\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`swlee_ticker\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"where\"}),\" col2 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'eth_krw'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"group\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"by\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"order\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"by\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),` a1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"left\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"join\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"select\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"distinct\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),` original_timestamp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),` col1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" trading\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`swlee_ticker\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"where\"}),\" col2 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'eth_krw'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"order\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"by\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),` b1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"on\"}),\" a1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"open_timestamp \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" b1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`original_timestamp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"left\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"join\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"select\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"distinct\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),` original_timestamp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),` col1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" trading\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`swlee_ticker\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"where\"}),\" col2 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'eth_krw'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"order\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"by\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),` c1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"on\"}),\" a1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"close_timestamp \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" c1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`original_timestamp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"where\"}),\" a1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"timestamp\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"is\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"not\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"null\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"order\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"by\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]})]})}),(0,e.jsx)(n.div,{className:\"remark-code-title\",children:\"30\\uBD84\"}),(0,e.jsx)(n.pre,{className:\"language-sql\",children:(0,e.jsxs)(n.code,{className:\"language-sql code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"select\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    a1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"timestamp\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" a1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`open_timestamp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" b1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"col1 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"open\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" a1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`close_timestamp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" c1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"col1 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"close\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" a1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`high\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" a1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`low\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"select\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"case\"}),\" floor\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"minute\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"/\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"30\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"when\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"then\"}),\" date_format\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"date_trunc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'second'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"interval\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'9'\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"hour\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'%Y-%m-%d %H:00'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"when\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"then\"}),\" date_format\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"date_trunc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'second'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"interval\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'9'\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"hour\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'%Y-%m-%d %H:30'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"end\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"timestamp\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"min\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),` open_timestamp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"max\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),` close_timestamp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"max\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),` high\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"min\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),` low\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" trading\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`swlee_ticker\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"where\"}),\" col2 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'eth_krw'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"group\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"by\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"order\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"by\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),` a1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"left\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"join\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"select\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"distinct\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),` original_timestamp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),` col1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" trading\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`swlee_ticker\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"where\"}),\" col2 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'eth_krw'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"order\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"by\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),` b1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"on\"}),\" a1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"open_timestamp \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" b1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`original_timestamp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"left\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"join\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"select\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"distinct\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),` original_timestamp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),` col1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" trading\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`swlee_ticker\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"where\"}),\" col2 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'eth_krw'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"order\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"by\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),` c1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"on\"}),\" a1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"close_timestamp \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" c1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`original_timestamp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"where\"}),\" a1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"timestamp\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"is\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"not\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"null\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"order\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"by\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]})]})}),(0,e.jsx)(n.div,{className:\"remark-code-title\",children:\"1\\uC2DC\\uAC04\"}),(0,e.jsx)(n.pre,{className:\"language-sql\",children:(0,e.jsxs)(n.code,{className:\"language-sql code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"select\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    a1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"timestamp\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" a1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`open_timestamp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" b1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"col1 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"open\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" a1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`close_timestamp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" c1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"col1 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"close\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" a1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`high\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" a1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`low\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"select\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"case\"}),\" floor\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"minute\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"when\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"then\"}),\" date_format\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"date_trunc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'hour'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"interval\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'9'\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"hour\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'%Y-%m-%d %H:00'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"end\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"timestamp\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"min\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),` open_timestamp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"max\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),` close_timestamp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"max\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),` high\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"min\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),` low\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" trading\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`swlee_ticker\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"where\"}),\" col2 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'eth_krw'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"group\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"by\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"order\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"by\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" a1 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"left\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"join\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"select\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"distinct\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),` original_timestamp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),` col1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" trading\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`swlee_ticker\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"where\"}),\" col2 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'eth_krw'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"order\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"by\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),` b1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"on\"}),\" a1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"open_timestamp \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" b1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`original_timestamp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"left\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"join\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"select\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"distinct\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),` original_timestamp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),` col1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" trading\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`swlee_ticker\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"where\"}),\" col2 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'eth_krw'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"order\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"by\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),` c1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"on\"}),\" a1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"close_timestamp \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" c1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`original_timestamp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"where\"}),\" a1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"timestamp\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"is\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"not\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"null\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"order\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"by\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]})]})}),(0,e.jsx)(n.div,{className:\"remark-code-title\",children:\"4\\uC2DC\\uAC04\"}),(0,e.jsx)(n.pre,{className:\"language-sql\",children:(0,e.jsxs)(n.code,{className:\"language-sql code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"select\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    a1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"timestamp\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" a1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`open_timestamp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" b1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"col1 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"open\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" a1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`close_timestamp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" c1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"col1 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"close\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" a1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`high\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" a1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`low\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"select\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"case\"}),\" floor\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"hour\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"/\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"4\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"when\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"then\"}),\" date_format\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"date_trunc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'hour'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"interval\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'9'\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"hour\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'%Y-%m-%d 00:00'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"when\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"then\"}),\" date_format\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"date_trunc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'hour'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"interval\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'9'\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"hour\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'%Y-%m-%d 04:00'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"when\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"then\"}),\" date_format\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"date_trunc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'hour'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"interval\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'9'\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"hour\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'%Y-%m-%d 08:00'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"when\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"3\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"then\"}),\" date_format\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"date_trunc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'hour'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"interval\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'9'\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"hour\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'%Y-%m-%d 12:00'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"when\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"4\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"then\"}),\" date_format\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"date_trunc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'hour'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"interval\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'9'\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"hour\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'%Y-%m-%d 16:00'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"when\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"5\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"then\"}),\" date_format\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"date_trunc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'hour'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"interval\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'9'\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"hour\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'%Y-%m-%d 18:00'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"end\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"timestamp\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"min\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),` open_timestamp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"max\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),` close_timestamp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"max\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),` high\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"min\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),` low\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" trading\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`swlee_ticker\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"where\"}),\" col2 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'eth_krw'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"group\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"by\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"order\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"by\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" a1 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"left\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"join\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"select\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"distinct\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),` original_timestamp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),` col1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" trading\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`swlee_ticker\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"where\"}),\" col2 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'eth_krw'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"order\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"by\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),` b1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"on\"}),\" a1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"open_timestamp \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" b1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`original_timestamp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"left\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"join\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"select\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"distinct\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        from_iso8601_timestamp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"col0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),` original_timestamp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),` col1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" trading\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`swlee_ticker\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"where\"}),\" col2 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'eth_krw'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"order\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"by\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),` c1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"on\"}),\" a1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"close_timestamp \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" c1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`original_timestamp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"where\"}),\" a1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"timestamp\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"is\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"not\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"null\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"order\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"by\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`})]})}),(0,e.jsxs)(n.h2,{id:\"\\uC2E4\\uD589-\\uACB0\\uACFC\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#\\uC2E4\\uD589-\\uACB0\\uACFC\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uC2E4\\uD589 \\uACB0\\uACFC\"]}),(0,e.jsx)(n.div,{children:(0,e.jsx)(s,{alt:\"Write SQL\",src:\"/static/images/posts/2021/04/25/01_sql.png\",width:\"999\",height:\"822\"})}),(0,e.jsx)(n.div,{children:(0,e.jsx)(s,{alt:\"Run SQL\",src:\"/static/images/posts/2021/04/25/02_result.png\",width:\"845\",height:\"546\"})}),(0,e.jsxs)(n.h2,{id:\"\\uC815\\uB9AC\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#\\uC815\\uB9AC\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uC815\\uB9AC\"]}),(0,e.jsxs)(n.ul,{children:[(0,e.jsx)(n.li,{children:\"\\uAC00\\uC7A5 \\uAE30\\uBCF8\\uC774 \\uB418\\uB294 \\uCE94\\uB4E4 \\uC0DD\\uC131\\uB9CC\\uC73C\\uB85C \\uBCF5\\uC7A1\\uD558\\uACE0 \\uBE44\\uC6A9\\uC774 \\uB9CE\\uC774 \\uB4E0\\uB2E4.\"}),(0,e.jsx)(n.li,{children:\"\\uAE00\\uB8E8 \\uC11C\\uBE44\\uC2A4\\uC5D0\\uC11C \\uC0DD\\uC131\\uD558\\uB294 ticker \\uD14C\\uC774\\uBE14\\uC774 \\uBC30\\uCE58\\uC131\\uC774\\uB77C\\uC11C \\uC2E4\\uC2DC\\uAC04 \\uCE94\\uB4E4 \\uC870\\uD68C\\uAC00 \\uC5B4\\uB835\\uB2E4.\"})]}),(0,e.jsx)(n.p,{children:\"\\uC6D0\\uD558\\uB294 \\uC2DC\\uAC04 \\uD504\\uB808\\uC784\\uBCC4\\uB85C \\uCE94\\uB4E4 \\uB370\\uC774\\uD130\\uB97C \\uC0DD\\uC131\\uD558\\uB294 SQL \\uBB38\\uC744 \\uC791\\uC131\\uD558\\uB294 \\uAC83\\uC740 \\uC131\\uACF5\\uD588\\uC9C0\\uB9CC, \\uC704\\uC640 \\uAC19\\uC740 \\uC774\\uC720\\uB4E4\\uB85C \\uBE44\\uD6A8\\uC728\\uC801\\uC774\\uB77C\\uACE0 \\uD310\\uB2E8\\uD574 \\uC791\\uC5C5\\uC5D0 \\uC0AC\\uC6A9\\uB41C \\uBAA8\\uB4E0 AWS \\uB9AC\\uC18C\\uC2A4(resource)\\uB97C \\uC0AD\\uC81C\\uD558\\uACE0 \\uB2E4\\uB978 \\uBC29\\uBC95\\uC744 \\uC2DC\\uB3C4\\uD558\\uAC8C \\uB418\\uC5C8\\uB2E4.\"})]})}function f(a={}){let{wrapper:n}=a.components||{};return n?(0,e.jsx)(n,Object.assign({},a,{children:(0,e.jsx)(d,a)})):d(a)}var b=f;function v(a,n,s){throw new Error(\"Expected \"+(n?\"component\":\"object\")+\" `\"+a+\"` to be defined: you likely forgot to import, pass, or provide it.\"+(s?\"\\nIt\\u2019s referenced in your code at `\"+s+\"` in `/Users/mzc02-swlee/dev/repository/seungwoo321.vercel.app/_mdx_bundler_entry_point-6a4058da-e92c-4032-bd13-110055e42876.mdx`\":\"\"))}return _(x);})();\n;return Component;"
  },
  "_id": "blog/trading-bot/making-trading-bot-1.mdx",
  "_raw": {
    "sourceFilePath": "blog/trading-bot/making-trading-bot-1.mdx",
    "sourceFileName": "making-trading-bot-1.mdx",
    "sourceFileDir": "blog/trading-bot",
    "contentType": "mdx",
    "flattenedPath": "blog/trading-bot/making-trading-bot-1"
  },
  "type": "Blog",
  "readingTime": {
    "text": "8 min read",
    "minutes": 7.74,
    "time": 464400,
    "words": 1548
  },
  "slug": "trading-bot/making-trading-bot-1",
  "path": "blog/trading-bot/making-trading-bot-1",
  "filePath": "blog/trading-bot/making-trading-bot-1.mdx",
  "toc": [
    {
      "value": "수집 및 데이터 가공",
      "url": "#수집-및-데이터-가공",
      "depth": 2
    },
    {
      "value": "가공 프로세스",
      "url": "#가공-프로세스",
      "depth": 3
    },
    {
      "value": "Athena SQL을 사용해 시장 데이터를 캔들 데이터로 가공하기",
      "url": "#athena-sql을-사용해-시장-데이터를-캔들-데이터로-가공하기",
      "depth": 2
    },
    {
      "value": "실행 결과",
      "url": "#실행-결과",
      "depth": 2
    },
    {
      "value": "정리",
      "url": "#정리",
      "depth": 2
    }
  ]
}